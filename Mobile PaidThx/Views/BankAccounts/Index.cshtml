@model Mobile_PaidThx.Models.BankAccountModels.BankAccountsModel

@{
    ViewBag.Title = "Linked Bank Accounts";
    ViewBag.PageID = "preferences-bankaccounts-page";
    ViewBag.Classes = "page settings";
}

<div  id="@ViewBag.PageID" class="@ViewBag.Classes"  >
    

    <div data-role="header" data-position="fixed" class="header-pdthx" >
    
        <h1>
            Bank Accounts</h1>
        <a href="@Url.Content("~/Preferences")"  class="hd-btn-left btn-back">Back</a>
    </div>
    <div data-role="content">
    <div class="pad">
 <div id="accounts-list">
        @Html.ValidationSummary()
        <h5>
            Your Linked Accounts</h5>
        <ul data-role="listview" data-inset="true">
            @foreach (var bankAccount in Model.PaymentAccounts)
            {             
                <li class="settings bank"><a href="@Url.Content("~/BankAccounts/Edit/" + bankAccount.PaymentAccountId)">
                                      
                    <span class="bank-info">
                        <h2>@{if(!string.IsNullOrEmpty(bankAccount.Nickname)){
                                  <text>@bankAccount.Nickname</text>;
                             } else{
                                  <text>@bankAccount.AccountType - @bankAccount.AccountNumber</text>
                              }
                              
                              }
                              </h2> 
                        <h4>@bankAccount.Status</h4>
                        
                    </span>
                </a></li>
            }
            </ul>
            <ul data-role="listview" data-inset="true">
            <li class="settings add">
                <a href="@Url.Content("~/BankAccounts/Add")">
                    Add an Account
                </a>
            </li>
            </ul>
            <h5>Sending Account</h5>
            <div class="select-holder">
            @using (Html.BeginForm("SetPreferredSendAccount", "BankAccounts", FormMethod.Post, new Dictionary<string, object> { { "data-transition", "slide-up" } }))
            {     
                @Html.DropDownList("PaymentAccountId", new SelectList(Model.PaymentAccounts, "PaymentAccountId", "Nickname", Model.PreferredSendAccountId), new { onchange = "this.form.submit();", @id = "ddlPreferredSendAccount", @class = "select-custom" })
            }
            </div>
            <h5>Receiving Account</h5>
            <div class="select-holder">
            @using (Html.BeginForm("SetPreferredReceiveAccount", "BankAccounts", FormMethod.Post, new Dictionary<string, object> { { "data-transition", "slide-up" } }))
            { 
                @Html.DropDownList("PaymentAccountId", new SelectList(Model.PaymentAccounts, "PaymentAccountId", "Nickname", Model.PreferredReceiveAccountId), new { onchange = "this.form.submit();", @id = "ddlPreferredReceiveAccount", @class = "select-custom" })
            }
            </div>
    </div>
    </div>
</div>
</div>

@section PageStyles{
<link type="text/css" rel="stylesheet" href="@Url.Content("~/Libs/dropkick/dropkick.css")">
<link type="text/css" rel="stylesheet" href="@Url.Content("~/Libs/dropkick/theme.css")">
}
@section PageScripts{

<script type="text/javascript" src="@Url.Content("~/Libs/dropkick/jquery.dropkick-1.0.0.js")"></script>

<script type="text/javascript">
$(document).ready(function() {
    $('.select-custom').dropkick();
});
</script>
}